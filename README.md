# Курс "Введение в эффективные системы глубокого обучения" для бакалавров 4 курса кафедры ММП ВМК МГУ, осенний семестр

Этот репозиторий содержит материалы к курсу "Введение в эффективные системы глубокого обучения", читаемого бакалаврам 4 курса кафедры ММП факультета ВМК МГУ в осеннем семестре 2025 года.

## О курсе

* Обязательный курс для студентов кафедры ММП 4 курса, 7 семестр
* Отчётность: зачёт, экзамен
* Время проведения: лекции во **вторник 10:30-12:05**, семинары во **вторник 12:15-13:50**
* Аудитория: 

Курс во многом основан на:

[Efficient DL Systems course by YSDA](https://github.com/mryab/efficient-dl-systems)

[Efficient AI Models course by Skoltech](https://github.com/On-Point-RND/Efficient-AI-Models)

## Базовый минимум (пререквизиты)

* [Курс глубокого обучения](https://github.com/mmp-practicum-team/mmp_dl_spring_2025)
*  Подразумевается, что слушатели неплохо знакомы с PyTorch, повторить можно по [документации](https://docs.pytorch.org/tutorials/beginner/pytorch_with_examples.html) или по [любому](https://www.youtube.com/watch?v=LyJtbe__2i0) "crash course" в интернете
* Мы будем ожидать, что вы хорошо знакомы с трансформерной архитектурой. Чтобы разобраться и освежить в памяти, можно почитать [оригинальную статью](https://arxiv.org/pdf/1706.03762) и посмотреть подробное [видео](https://youtu.be/kCc8FmEb1nY?si=u56699N1jEyEA6TQ)
* В курсе будем много рассказывать про обучение LLM моделей и про то, как ускорить этот процесс. Советуем вспомнить [основные моменты](https://www.youtube.com/watch?v=l8pRSuU81PU&)
* Желательно понимать основы вычислений на GPU, есть [хорошая и понятная статья](https://horace.io/brrr_intro.html)


## Роскошный максимум (план занятий)

| Дата | Номер | Тема | Материалы | ДЗ |
| :---: | :---: | --- | --- | --- |
| 9 сентября | Лекция  01 | Архитектура GPU | [Презентация](./Seminars/01-gpu-and-cuda/lecture.pdf) | [Умножение векторов и матриц с использованием CUDA](./Tasks/task1/task_01.ipynb) |
| 9 сентября | Семинар 01 | Bведение в CUDA | [Ноутбук](./Seminars/01-gpu-and-cuda/cuda_seminar.ipynb)  | ¯\\\_(ツ)\_/¯ |
| 16 сентября | Лекция  02 | Базовые методы ускорения обучения | - | Базовые методы ускорения обучения |
| 16 сентября | Семинар 02 | Профилирование в Pytorch | - | ¯\\\_(ツ)\_/¯ |
| 23 сентября | Лекция  03 | Задача инференса | - | ¯\\\_(ツ)\_/¯ |
| 23 сентября | Семинар  03 | Введение в triton | - | ¯\\\_(ツ)\_/¯ |
| 30 сентября | Лекция  04 | Сжатие нейронных сетей | - | Методы сжатия нейронных сетей |
| 30 сентября | Семинар  04 | Низкая битность в triton | - | ¯\\\_(ツ)\_/¯  |
| 7 октября | Лекция  05 | Другие методы ускорения инференса | - | ¯\\\_(ツ)\_/¯  |
| 7 октября | Семинар  05 | Библиотеки для ускорения инференса | - | ¯\\\_(ツ)\_/¯  |
| 14 октября | Лекция  06 | Работа с большими моделями на одной GPU | - | Работа с большими моделями на одной GPU |
| 14 октября | Семинар  06 | Граф вычислений с точки зрения эффективности | - | ¯\\\_(ツ)\_/¯  |
| 21 октября | Лекция  07 | Введение в распределенные вычисления | - | ¯\\\_(ツ)\_/¯  |
| 21 октября | Семинар  07 | Основы torch.distributed | - | ¯\\\_(ツ)\_/¯  |
| 28 октября | Лекция  08 | Операция All Reduce, DDP | - | ¯\\\_(ツ)\_/¯  |
| 28 октября | Семинар  08 | Реализация All Reduce на torch.distributed, DDP | - | ¯\\\_(ツ)\_/¯  |
| 11 ноября | Лекция  09 | Fully Sharded Data Parallel | - | FSDP своими руками  |
| 11 ноября | Семинар  09 | DTensor, Tensor Parallel | - | ¯\\\_(ツ)\_/¯  |
| 18 ноября | Лекция  09 | Другие виды параллелизма: Tensor & Sequential Parallel, MoE | - | ¯\\\_(ツ)\_/¯  |
| 25 ноября | Лекция  10 | Автоматический подбор гиперпараметров | - | ¯\\\_(ツ)\_/¯  |
| 2 декабря | Лекция  11 | AutoML | - |AutoML  |
| 9 декабря | Лекция  12 | Neural Architecture Search | - | ¯\\\_(ツ)\_/¯  |
| 16 декабря | Лекция  12 | Efficient DL in the Wild | - | ¯\\\_(ツ)\_/¯  |

## Формат сдачи курса

### Правила оценивания

* Зачет за курс выставляется при получении оценки хорошо и выше
* Оценка за курс выставляется по результатам выполнения домашних заданий и экзамена
* В рамках семестра предполагается выполнить **шесть** практических заданий стоимостью 10 баллов каждое.
* За каждый день просрочки задания назначается штраф — 1 балл.
  * B ≥ 48 и 5 практических заданий сданы на балл ≥ 4 ⇒ отлично
  * B ≥ 36 и 4 практических задания сданы на балл ≥ 4 ⇒ хорошо
  * B ≥ 30 и 3 практических задания сданы на балл ≥ 4 ⇒ удовлетворительно
  * иначе ⇒ неудовлетворительно
* Экзамен является обязательным
* По результатам экзамена студент может, либо:
  * Подтвердить оценку за выполнение практических заданий
  * Получить оценку на балл ниже, чем накопленная за практические задания
  * Получить оценку на балл выше, чем накопленная за практические задания
  * Получить оценку неудовлетворительно

### Формат сдачи экзамена
* Экзамен проходит во второй половине **декабря**
* Формат экзамена будет уточнен ближе к зиме

### Эффективный отдых

* В рамках курса студенты могут выполнить ряд внеучебных заданий и получить возможность перенести дедлайн **двух** домашних заданий на **14 декабря 2025**. 
* Нельзя переносить дедлайны *первого* и *последнего* задания
* При переносе дедлайна новый дедлайн становится жестким, при этом штрафы пропадают
* Дедлайн переносится для всей группы сразу, для этого староста должна написать решение группы в чат курса
* Группа может попросить перенести дедлайн **до** получения льготы. При этом, если льгота получена в итоге не будет, то домашнее задание будет проверено как в обычные сроки
* Чтобы задание было выполнено, студенты должны предоставить доказательство его выполнения в чат курса
* Чтобы задание было зачтено, его должно выполнить **не менее 10 человек**
* Для получения льготы надо выполнить **все** задания
* Список заданий:
    1) Сходить на культурное мероприятие по пушкинской карте
    2) Сделать групповое фото в/около следующих локациях Москвы: Аптекарский Огород МГУ, Останкинская Телебашня, Большой Царицынский дворец, Центральный Детский Мир, ФКН НИУ ВШЭ
    3) Поиграть в любой командный вид спорта 
    4) Сделать в пяти точках Москвы надпись "ММП" с помощью приложения для отслеживания бега примерно в одно время (+- полчаса)


